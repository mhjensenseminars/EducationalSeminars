<!DOCTYPE html>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Integrating computations, mathematics, physics and chemistry in undergraduate biology programs">

<title>Integrating computations, mathematics, physics and chemistry in undergraduate biology programs</title>







<!-- reveal.js: http://lab.hakim.se/reveal-js/ -->

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

<link rel="stylesheet" href="reveal.js/css/reveal.css">
<link rel="stylesheet" href="reveal.js/css/theme/darkgray.css" id="theme">
<!--
<link rel="stylesheet" href="reveal.js/css/reveal.css">
<link rel="stylesheet" href="reveal.js/css/theme/beige.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/beigesmall.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/solarized.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/serif.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/night.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/moon.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/simple.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/sky.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/darkgray.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/default.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/cbc.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/simula.css" id="theme">
-->

<!-- For syntax highlighting -->
<link rel="stylesheet" href="reveal.js/lib/css/zenburn.css">

<!-- If the query includes 'print-pdf', use the PDF print sheet -->
<script>
document.write( '<link rel="stylesheet" href="reveal.js/css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
</script>

<style type="text/css">
    hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    p.caption { width: 80%; font-size: 60%; font-style: italic; text-align: left; }
    hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    .reveal .alert-text-small   { font-size: 80%;  }
    .reveal .alert-text-large   { font-size: 130%; }
    .reveal .alert-text-normal  { font-size: 90%;  }
    .reveal .alert {
             padding:8px 35px 8px 14px; margin-bottom:18px;
             text-shadow:0 1px 0 rgba(255,255,255,0.5);
             border:5px solid #bababa;
             -webkit-border-radius: 14px; -moz-border-radius: 14px;
             border-radius:14px
             background-position: 10px 10px;
             background-repeat: no-repeat;
             background-size: 38px;
             padding-left: 30px; /* 55px; if icon */
     }
     .reveal .alert-block {padding-top:14px; padding-bottom:14px}
     .reveal .alert-block > p, .alert-block > ul {margin-bottom:1em}
     /*.reveal .alert li {margin-top: 1em}*/
     .reveal .alert-block p+p {margin-top:5px}
     /*.reveal .alert-notice { background-image: url(http://hplgit.github.io/doconce/bundled/html_images/small_gray_notice.png); }
     .reveal .alert-summary  { background-image:url(http://hplgit.github.io/doconce/bundled/html_images/small_gray_summary.png); }
     .reveal .alert-warning { background-image: url(http://hplgit.github.io/doconce/bundled/html_images/small_gray_warning.png); }
     .reveal .alert-question {background-image:url(http://hplgit.github.io/doconce/bundled/html_images/small_gray_question.png); } */

</style>



<!-- Styles for table layout of slides -->
<style type="text/css">
td.padding {
  padding-top:20px;
  padding-bottom:20px;
  padding-right:50px;
  padding-left:50px;
}
</style>

</head>

<body>
<div class="reveal">

<!-- Any section element inside the <div class="slides"> container
     is displayed as a slide -->

<div class="slides">





<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    



<section>
<!-- ------------------- main content ---------------------- -->



<center><h1 style="text-align: center;">Integrating computations, mathematics, physics and chemistry in undergraduate biology programs</h1></center>  <!-- document title -->

<p>
<!-- author(s): Morten Hjorth-Jensen, and Hans Petter Langtangen -->

<center>
<b>Morten Hjorth-Jensen</b> [1, 2]
</center>

<center>
<b>Hans Petter Langtangen</b> [3, 4]
</center>


<p>&nbsp;<br>
<!-- institution(s) -->

<center>[1] <b>Dept. of Physics, UiO</b></center>
<center>[2] <b>Dept. of Physics, Michigan State University</b></center>
<center>[3] <b>Dept. of Informatics, UiO</b></center>
<center>[4] <b>Center for Biomedical Computing, Simula</b></center>
<p>&nbsp;<br>
<center><h4>Feb 25, 2015</h4></center> <!-- date -->
<p>

</section>


<section>

<h2 id="___sec0">Overarching questions </h2>

<p>

<div class="fragment alert alert-block alert-block alert-text-normal">
<b>Which skills are needed by MSc candidates in biology?</b>
<p>
There is new demand for more

<ul>
  <p><li class="fragment"> quantitative methods &amp; reasoning</li>
  <p><li class="fragment"> understanding data and phenomena via models</li>
  <p><li class="fragment"> creating <em>in silico</em> virtual labs</li>
</ul>
</div>



<p>

<div class="fragment alert alert-block alert-block alert-text-normal">
<b>Challenge:</b>
<p>
How to integrate such computing-based activities in the bachelor programs
when the students are <em>not</em> interested in mathematics, physics, and
programming?
</div>



<p>

</section>


<section>

<h2 id="___sec1">How to teach computing in biology? </h2>

<p>

<div class="fragment alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Do we need to still follow the tradition and teach mathematics, physics, computations, chemistry, etc. in separate discipline-specific courses?

<ul>
  <p><li class="fragment"> Uninteresting to first study tools when you want to study biology</li>
  <p><li class="fragment"> Little understanding of what the tools are good for</li>
  <p><li class="fragment"> Minor utilization of tools later in biology</li>
</ul>
</div>



<p>

<div class="fragment alert alert-block alert-block alert-text-normal">
<b>It's time for new thinking:</b>
<p>

<ul>
  <p><li class="fragment"> Just-in-time teaching: teach tools <em>when needed</em></li>
  <p><li class="fragment"> Teach tools in the <em>context of biology</em></li>
  <p><li class="fragment"> Emphasize development of <em>intuition and understanding</em></li>
  <p><li class="fragment"> Base learning of the students' own <em>explorations in biology projects</em></li>
  <p><li class="fragment"> Integrate lab work with computing tools</li>
</ul>
</div>



<p>

</section>


<section>

<h2 id="___sec2">Current status: CSE is ready for biology </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
 <p><li> CSE (<em>Computing in Science Education</em>) in life science is a faculty
   priority area</li>
 <p><li> Core professors in the CSE project and 5 IBV professors
   are dedicated to implementation</li>
 <p><li> 4 CINPLA PhD students have excellent background for and strong interests
   in the implementation</li>
 <p><li> Let's roll!</li>
</ul>
</div>


<p>

</section>


<section>

<h2 id="___sec3">Suggested pilot project: Oct 2014 - Oct 2015 </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
 <p><li> Form a project team of dedicated CSE+IBV people and CINPLA PhD students</li>
 <p><li> Develop a pedagogical framework</li>
 <p><li> CSE+IBV people identify a set of possible examples</li>
 <p><li> PhD students work closely with CSE+IBV people to find data,
   define models, and write documents</li>
 <p><li> Spring 2015: intro course in computing and programming for IBV teachers, using selected examples</li>
 <p><li> Educational workshop at IBV:</li>

<ul>
   <p><li> Present results from the project</li>
   <p><li> Discuss how and where to implement examples in BIOxxxx courses</li>
</ul>
<p>

 <p><li> Fall 2016: First integration of computing in courses</li>
</ul>
</div>


<p>

</section>


<section>

<h2 id="___sec4">The pedagogical framework </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Aim: Develop intuition about the scientific method.</b>
<p>

<ul>
 <p><li> Method: case-based learning</li>
 <p><li> Coherent problem solving <em>in biology</em> by integrating
   mathematics, programming, physics/chemistry, ...</li>
 <p><li> Starting point: data from lab or field experiments</li>
 <p><li> Visualize data</li>
 <p><li> Derive computational models directly from mathematical/intuitive <em>reasoning</em></li>
 <p><li> Program model(s), fit parameters, compare with data</li>
 <p><li> Develop intuition and understanding based on</li>

<ul>
  <p><li> the principles behind the model</li>
  <p><li> exploration of the model (&quot;what if&quot;)</li>
  <p><li> prediction of new experiments</li>
</ul>
<p>

</ul>
</div>


<p>

</section>


<section>

<h2 id="___sec5">Example 1: ecoli lab experiment </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Observations of no of bacteria vs time in seconds,
stored in Excel and written to a CVS file:

<p>

<!-- code=text (!bc txt) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 80%; line-height: 125%">0,100
600,140
1200,250
1800,360
2400,480
3000,820
3600,1300
4200,1700
4800,2900
5400,3900
6000,7000
</pre></div>

</div>


<p>

</section>


<section>

<h2 id="___sec6">Visualize data </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
 <p><li> Meet a text editor and a terminal window</li>
 <p><li> Very basic Unix</li>
</ul>
<p>

First program:

<p>

<!-- code=python (!bc pypro) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 80%; line-height: 125%"><span style="color: #d0d0d0">t</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">[</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">600</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">1200</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">1800</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">2400</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">3000</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">3600</span><span style="color: #d0d0d0">,</span>
     <span style="color: #3677a9">4200</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">4800</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">5400</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">6000</span><span style="color: #d0d0d0">]</span>
<span style="color: #d0d0d0">N</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">[</span><span style="color: #3677a9">100</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">140</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">250</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">360</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">480</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">820</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">1300</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">1700</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">2900</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">3900</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">7000</span><span style="color: #d0d0d0">]</span>
<span style="color: #6ab825; font-weight: bold">import</span> <span style="color: #447fcf; text-decoration: underline">matplotlib.pyplot</span> <span style="color: #6ab825; font-weight: bold">as</span> <span style="color: #447fcf; text-decoration: underline">plt</span>
<span style="color: #d0d0d0">plt.plot(t,</span> <span style="color: #d0d0d0">N,</span> <span style="color: #ed9d13">&#39;ro&#39;</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">plt.xlabel(</span><span style="color: #ed9d13">&#39;t [s]&#39;</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">plt.ylabel(</span><span style="color: #ed9d13">&#39;N&#39;</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">plt.show()</span>
</pre></div>

</div>


<p>

</section>


<section>

<h2 id="___sec7">Concepts must be introduced implicitly in a structured way </h2>

<p>
<div class="alert alert-block alert-warning alert-text-normal">
<b>Warning.</b>
<p>

<ul>
 <p><li> Always identify new concepts</li>
 <p><li> Train new concepts in simplified (&quot;trivial&quot;) problems</li>
</ul>
</div>


<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Concepts in the previous example:</b>
<p>

<ul>
 <p><li> Lists or arrays of numbers</li>
 <p><li> Plotting commands</li>
 <p><li> Curve = function of time</li>
</ul>
</div>


<p>
<div class="alert alert-block alert-notice alert-text-normal">
<b>Notice:</b>
<p>
The concept of a continuous function \( N(t) \) is not necessary,
just straight lines between discrete points on a curve.
</div>


<p>

</section>


<section>

<h2 id="___sec8">Read data from file </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
<p>

<!-- code=python (!bc pypro) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">import</span> <span style="color: #447fcf; text-decoration: underline">numpy</span> <span style="color: #6ab825; font-weight: bold">as</span> <span style="color: #447fcf; text-decoration: underline">np</span>
<span style="color: #d0d0d0">data</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">np.loadtxt(</span><span style="color: #ed9d13">&#39;ecoli.csv&#39;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">delimiter=</span><span style="color: #ed9d13">&#39;,&#39;</span><span style="color: #d0d0d0">)</span>
<span style="color: #6ab825; font-weight: bold">print</span> <span style="color: #d0d0d0">data</span>  <span style="color: #999999; font-style: italic"># look at the format</span>
<span style="color: #d0d0d0">t</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">data[:,</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">]</span>
<span style="color: #d0d0d0">N</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">data[:,</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]</span>
<span style="color: #6ab825; font-weight: bold">import</span> <span style="color: #447fcf; text-decoration: underline">matplotlib.pyplot</span> <span style="color: #6ab825; font-weight: bold">as</span> <span style="color: #447fcf; text-decoration: underline">plt</span>
<span style="color: #d0d0d0">plt.plot(t,</span> <span style="color: #d0d0d0">N,</span> <span style="color: #ed9d13">&#39;ro&#39;</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">plt.xlabel(</span><span style="color: #ed9d13">&#39;t [s]&#39;</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">plt.ylabel(</span><span style="color: #ed9d13">&#39;N&#39;</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">plt.show()</span>
</pre></div>

</div>


<p>
<div class="alert alert-block alert-notice alert-text-normal">
<b>Typical pattern:</b>
<p>
The population grows faster and faster. Why? Is there an
underlying (general) mechanism?
</div>


<p>

</section>


<section>

<h2 id="___sec9">Lab journal </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Use IPython notebook as lab journal.
</div>


<p>

</section>


<section>

<h2 id="___sec10">How can we reason about the process? </h2>

<p>
<!-- <a href="http://www.zo.utexas.edu/courses/Thoc/PopGrowth.html" target="_self"><tt>http://www.zo.utexas.edu/courses/Thoc/PopGrowth.html</tt></a> -->

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>


<ol>
<p><li class="fragment"> Cells divide after \( T \) seconds on average (one generation)</li>
<p><li class="fragment"> \( 2N \) celles divide otn twice as many new cells \( \Delta N \) in a time
   interval \( \Delta t \) as \( N \) cells would: \( \Delta N \propto N \)</li>
<p><li class="fragment"> \( N \) cells result in twice as many new individuals \( \Delta N \) in
   time \( 2\Delta t \) as in time \( \Delta t \): \( \Delta N \propto\Delta t \)</li>
<p><li class="fragment"> Same proportionality wrt death (repeat reasoning)</li>
<p><li class="fragment"> Proposed model: \( \Delta N = b\Delta t N - d\Delta tN \) for some unknown
   constants \( b \) (births) and \( d \) (deaths)</li>
<p><li class="fragment"> Describe evolution in discrete time: \( t_n=n\Delta t \)</li>
<p><li class="fragment"> Program-friendly notation: \( N \) at \( t_n \) is \( N^n \)</li>
<p><li class="fragment"> Math model: \( N^{n+1} = N^n + r\Delta t\, N \) (with \( \ r=b-d \))</li>
<p><li class="fragment"> Program model: <code>N[n+1] = N[n] + r*dt*N[n]</code></li>
</ol>


</div>


<p>

</section>


<section>

<h2 id="___sec11">The first simple program </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Let us solve the difference equation in as simple way as possible,
just to train some programming: \( r=1.5 \), \( N^0=1 \), \( \Delta t=0.5 \)

<p>

<!-- code=python (!bc pypro) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">import</span> <span style="color: #447fcf; text-decoration: underline">numpy</span> <span style="color: #6ab825; font-weight: bold">as</span> <span style="color: #447fcf; text-decoration: underline">np</span>

<span style="color: #d0d0d0">t</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">np.linspace(</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">10</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">21</span><span style="color: #d0d0d0">)</span>  <span style="color: #999999; font-style: italic"># 20 intervals in [0, 10]</span>
<span style="color: #d0d0d0">dt</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">t[</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">-</span> <span style="color: #d0d0d0">t[</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">]</span>
<span style="color: #d0d0d0">N</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">np.zeros(t.size)</span>

<span style="color: #d0d0d0">N[</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">1</span>
<span style="color: #d0d0d0">r</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">0.5</span>

<span style="color: #6ab825; font-weight: bold">for</span> <span style="color: #d0d0d0">n</span> <span style="color: #6ab825; font-weight: bold">in</span> <span style="color: #24909d">range</span><span style="color: #d0d0d0">(</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">N.size-</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">1</span><span style="color: #d0d0d0">):</span>
    <span style="color: #d0d0d0">N[n+</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">N[n]</span> <span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">r*dt*N[n]</span>
    <span style="color: #6ab825; font-weight: bold">print</span> <span style="color: #ed9d13">&#39;N[%d]=%.1f&#39;</span> <span style="color: #d0d0d0">%</span> <span style="color: #d0d0d0">(n+</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">N[n+</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">])</span>
</pre></div>

</div>


<p>

</section>


<section>

<h2 id="___sec12">The output </h2>

<p>

<!-- code=text typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 80%; line-height: 125%">N[1]=1.2
N[2]=1.6
N[3]=2.0
N[4]=2.4
N[5]=3.1
N[6]=3.8
N[7]=4.8
N[8]=6.0
N[9]=7.5
N[10]=9.3
N[11]=11.6
N[12]=14.6
N[13]=18.2
N[14]=22.7
N[15]=28.4
N[16]=35.5
N[17]=44.4
N[18]=55.5
N[19]=69.4
N[20]=86.7
</pre></div>
<p>

</section>


<section>

<h2 id="___sec13">Parameter estimation </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
 <p><li> We do not know \( r \)</li>
 <p><li> How can we estimate \( r \) from data?</li>
</ul>
<p>

We can use the difference equation with the experimental data

<p>&nbsp;<br>
$$ N^{n+1} = N^n + r\Delta t N^n$$
<p>&nbsp;<br>

Say \( N^{n+1} \) and \( N^n \) are known from data, solve wrt \( r \):

<p>&nbsp;<br>
$$ r = \frac{N^{n+1}-N^n}{N^n\Delta t} $$
<p>&nbsp;<br>


<p>
Use experimental data in the fraction, say \( t_1=600 \), \( t_2=1200 \),
\( N^1=140 \), \( N^2=250 \): \( r=0.0013 \).
</div>


<p>
<div class="alert alert-block alert-notice alert-text-normal">
<b>More sophisticated methods.</b>
<p>
Can do a nonlinear least squares parameter fit, but that is
too advanced at this stage.
</div>


<p>

</section>


<section>

<h2 id="___sec14">A program relevant for the biological problem </h2>

<p>
<!-- exact r = 0.000694 -->

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
<p>

<!-- code=python (!bc pypro) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">import</span> <span style="color: #447fcf; text-decoration: underline">numpy</span> <span style="color: #6ab825; font-weight: bold">as</span> <span style="color: #447fcf; text-decoration: underline">np</span>

<span style="color: #999999; font-style: italic"># Estimate r</span>
<span style="color: #d0d0d0">data</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">np.loadtxt(</span><span style="color: #ed9d13">&#39;ecoli.csv&#39;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">delimiter=</span><span style="color: #ed9d13">&#39;,&#39;</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">t_e</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">data[:,</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">]</span>
<span style="color: #d0d0d0">N_e</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">data[:,</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]</span>
<span style="color: #d0d0d0">i</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">2</span>  <span style="color: #999999; font-style: italic"># Data point (i,i+1) used to estimate r</span>
<span style="color: #d0d0d0">r</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">(N_e[i+</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">-</span> <span style="color: #d0d0d0">N_e[i])/(N_e[i]*(t_e[i+</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">-</span> <span style="color: #d0d0d0">t_e[i]))</span>
<span style="color: #6ab825; font-weight: bold">print</span> <span style="color: #ed9d13">&#39;Estimated r=%.5f&#39;</span> <span style="color: #d0d0d0">%</span> <span style="color: #d0d0d0">r</span>
<span style="color: #999999; font-style: italic"># Can experiment with r values and see if the model can</span>
<span style="color: #999999; font-style: italic"># match the data better</span>

<span style="color: #d0d0d0">T</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">1200</span>     <span style="color: #999999; font-style: italic"># cell can divide after T sec</span>
<span style="color: #d0d0d0">t_max</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">5</span><span style="color: #d0d0d0">*T</span>  <span style="color: #999999; font-style: italic"># 5 generations in experiment</span>
<span style="color: #d0d0d0">t</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">np.linspace(</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">t_max,</span> <span style="color: #3677a9">1000</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">dt</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">t[</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">-</span> <span style="color: #d0d0d0">t[</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">]</span>
<span style="color: #d0d0d0">N</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">np.zeros(t.size)</span>

<span style="color: #d0d0d0">N[</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">100</span>
<span style="color: #6ab825; font-weight: bold">for</span> <span style="color: #d0d0d0">n</span> <span style="color: #6ab825; font-weight: bold">in</span> <span style="color: #24909d">range</span><span style="color: #d0d0d0">(</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">,</span> <span style="color: #24909d">len</span><span style="color: #d0d0d0">(t)-</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">1</span><span style="color: #d0d0d0">):</span>
    <span style="color: #d0d0d0">N[n+</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">N[n]</span> <span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">r*dt*N[n]</span>

<span style="color: #6ab825; font-weight: bold">import</span> <span style="color: #447fcf; text-decoration: underline">matplotlib.pyplot</span> <span style="color: #6ab825; font-weight: bold">as</span> <span style="color: #447fcf; text-decoration: underline">plt</span>
<span style="color: #d0d0d0">plt.plot(t,</span> <span style="color: #d0d0d0">N,</span> <span style="color: #ed9d13">&#39;r-&#39;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">t_e,</span> <span style="color: #d0d0d0">N_e,</span> <span style="color: #ed9d13">&#39;bo&#39;</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">plt.xlabel(</span><span style="color: #ed9d13">&#39;time [s]&#39;</span><span style="color: #d0d0d0">);</span>  <span style="color: #d0d0d0">plt.ylabel(</span><span style="color: #ed9d13">&#39;N&#39;</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">plt.legend([</span><span style="color: #ed9d13">&#39;model&#39;</span><span style="color: #d0d0d0">,</span> <span style="color: #ed9d13">&#39;experiment&#39;</span><span style="color: #d0d0d0">],</span> <span style="color: #d0d0d0">loc=</span><span style="color: #ed9d13">&#39;upper left&#39;</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">plt.show()</span>
</pre></div>
<p>
Change <code>r</code> in the program and play around to make a better fit!
</div>


<p>

</section>


<section>

<h2 id="___sec15">Discuss the nature of such a model </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
 <p><li> Write up all the biological factors that influence the
   population size of bacteria</li>
 <p><li> Understand that all such effects are merged into one parameter \( r \)</li>
 <p><li> Understand that the reasoning must be the same whether we
   have bacteria, animals or humans - this is a generic model!<br />
   (even the interest rate in a bank follows the same model)</li>
</ul>
</div>


<p>

</section>


<section>

<h2 id="___sec16">Discuss the limitations of such a model </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
 <p><li> How many bacteria in the lab after one month?</li>
 <p><li> Growth is restricted by environmental resources!</li>
 <p><li> Fix the model (logistic growth)</li>
 <p><li> Is the logistic model appropriate for a lab experiment?</li>
 <p><li> Find data to support the logistic model <br />
   (it's a <em>very</em> simple model)</li>
</ul>
</div>


<p>

</section>


<section>

<h2 id="___sec17">The pedagogical template (to be iterated!) </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
 <p><li> Start with a real biological problem</li>
 <p><li> Be careful with too many new concepts</li>
 <p><li> Workflow:</li>

<ul>
  <p><li> data</li>
  <p><li> visualization</li>
  <p><li> patterns</li>
  <p><li> modeling (<em>discrete</em>)</li>
  <p><li> programming</li>
  <p><li> testing</li>
  <p><li> parameter estimation (difficult)</li>
  <p><li> validation</li>
  <p><li> prediction</li>
</ul>
<p>

 <p><li> Make many small exercises that train the new concepts</li>
 <p><li> Repeat the case in a way that makes a complete understanding</li>
</ul>
</div>


<p>

</section>


<section>

<h2 id="___sec18">Technology for documenting cases </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
 <p><li> Documentation: slides in the doconce format with extra notes<br />
   (can compile with/without notes)</li>
 <p><li> Realistic goal: write out the slides for a gentle book on biocomputing examples</li>
 <p><li> The biological case is in a separate file that the students can work
   with as an IPython notebook</li>
 <p><li> Problem: not much basic literature exists</li>
 <p><li> Cases must be linked in a learning graph:<br />
   <em>I want to do nerve cell modeling, but how to progress to this stage?</em></li>
 <p><li> Make a list of concepts and where concepts are trained</li>
 <p><li> Think of each case as a <em>separate module</em></li>
</ul>
</div>


<p>

</section>


<section>

<h2 id="___sec19">Immediate tasks </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
 <p><li> Find a good bacteria growth lab example - do the first example</li>
 <p><li> Alternative model: random 2D walk, people meet and make new individuals</li>
 <p><li> Predator-pray model: any field experiment to build?</li>
 <p><li> Experiments based on technology: imaging, sensors, ...</li>
 <p><li> Disease modeling coupled to data</li>
 <p><li> Predator-pray with disease</li>
 <p><li> Bioinformatics cases and programming</li>
 <p><li> ...</li>
</ul>
</div>


<p>

</section>


<section>

<h2 id="___sec20">Adding model complexity: Predator-Prey model from ecology </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The population dynamics of a simple predator-prey system is a
classical example shown in many biology textbooks when ecological
systems are discussed. The system contains all elements of the
scientific method:

<ul>
 <p><li> The set up of a specific hypothesis combined with</li>
 <p><li> the experimental methods needed (one can study existing data or perform experiments)</li>
 <p><li> analyzing and interpreting the data and performing further experiments if needed</li>
 <p><li> trying to extract general behaviors and extract eventual laws or patterns</li>
 <p><li> develop mathematical relations for the uncovered regularities/laws and test these by performing new experiments</li>
</ul>
</div>


<p>

</section>


<section>

<h2 id="___sec21">Case study from Hudson bay </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Lots of data about populations of hares and lynx collected from furs in Hudson Bay, Canada, are available. It is known that the populations oscillate. Why?
We shall demonstrate the scientific method by

<ol>
<p><li> plotting the data</li>
<p><li> derive a simple model for the population dynamics</li>
<p><li> (fitting parameters in the model to the data)</li>
<p><li> using the model predict the evolution other predator-pray systems</li>
</ol>
</div>


<p>

</section>


<section>

<h2 id="___sec22">Hudson bay data </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<p>
<table border="1">
<thead>
<tr><th align="center">Year</th> <th align="center">Hares (x1000)</th> <th align="center">Lynx (x1000)</th> </tr>
</thead>
<tbody>
<tr><td align="left">   1900    </td> <td align="right">   30.0             </td> <td align="right">   4.0             </td> </tr>
<tr><td align="left">   1901    </td> <td align="right">   47.2             </td> <td align="right">   6.1             </td> </tr>
<tr><td align="left">   1902    </td> <td align="right">   70.2             </td> <td align="right">   9.8             </td> </tr>
<tr><td align="left">   1903    </td> <td align="right">   77.4             </td> <td align="right">   35.2            </td> </tr>
<tr><td align="left">   1904    </td> <td align="right">   36.3             </td> <td align="right">   59.4            </td> </tr>
<tr><td align="left">   1905    </td> <td align="right">   20.6             </td> <td align="right">   41.7            </td> </tr>
<tr><td align="left">   1906    </td> <td align="right">   18.1             </td> <td align="right">   19.0            </td> </tr>
<tr><td align="left">   1907    </td> <td align="right">   21.4             </td> <td align="right">   13.0            </td> </tr>
<tr><td align="left">   1908    </td> <td align="right">   22.0             </td> <td align="right">   8.3             </td> </tr>
<tr><td align="left">   1909    </td> <td align="right">   25.4             </td> <td align="right">   9.1             </td> </tr>
<tr><td align="left">   1910    </td> <td align="right">   27.1             </td> <td align="right">   7.4             </td> </tr>
<tr><td align="left">   1911    </td> <td align="right">   40.3             </td> <td align="right">   8.0             </td> </tr>
<tr><td align="left">   1912    </td> <td align="right">   57               </td> <td align="right">   12.3            </td> </tr>
<tr><td align="left">   1913    </td> <td align="right">   76.6             </td> <td align="right">   19.5            </td> </tr>
<tr><td align="left">   1914    </td> <td align="right">   52.3             </td> <td align="right">   45.7            </td> </tr>
<tr><td align="left">   1915    </td> <td align="right">   19.5             </td> <td align="right">   51.1            </td> </tr>
<tr><td align="left">   1916    </td> <td align="right">   11.2             </td> <td align="right">   29.7            </td> </tr>
<tr><td align="left">   1917    </td> <td align="right">   7.6              </td> <td align="right">   15.8            </td> </tr>
<tr><td align="left">   1918    </td> <td align="right">   14.6             </td> <td align="right">   9.7             </td> </tr>
<tr><td align="left">   1919    </td> <td align="right">   16.2             </td> <td align="right">   10.1            </td> </tr>
<tr><td align="left">   1920    </td> <td align="right">   24.7             </td> <td align="right">   8.6             </td> </tr>
</tbody>
</table>

</div>


<p>

</section>


<section>

<h2 id="___sec23">Plotting the data </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
<p>

<!-- code=python (!bc pypro) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">import</span> <span style="color: #447fcf; text-decoration: underline">numpy</span> <span style="color: #6ab825; font-weight: bold">as</span> <span style="color: #447fcf; text-decoration: underline">np</span>
<span style="color: #6ab825; font-weight: bold">from</span>  <span style="color: #447fcf; text-decoration: underline">matplotlib</span> <span style="color: #6ab825; font-weight: bold">import</span> <span style="color: #d0d0d0">pyplot</span> <span style="color: #6ab825; font-weight: bold">as</span> <span style="color: #d0d0d0">plt</span>

<span style="color: #999999; font-style: italic"># Load in data file</span>
<span style="color: #d0d0d0">data</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">np.loadtxt(</span><span style="color: #ed9d13">&#39;Hudson_Bay.dat&#39;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">delimiter=</span><span style="color: #ed9d13">&#39;,&#39;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">skiprows=</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">)</span>
<span style="color: #999999; font-style: italic"># Make arrays containing x-axis and hares and lynx populations</span>
<span style="color: #d0d0d0">year</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">data[:,</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">]</span>
<span style="color: #d0d0d0">hares</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">data[:,</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]</span>
<span style="color: #d0d0d0">lynx</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">data[:,</span><span style="color: #3677a9">2</span><span style="color: #d0d0d0">]</span>

<span style="color: #d0d0d0">plt.plot(year,</span> <span style="color: #d0d0d0">hares</span> <span style="color: #d0d0d0">,</span><span style="color: #ed9d13">&#39;b-+&#39;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">year,</span> <span style="color: #d0d0d0">lynx,</span> <span style="color: #ed9d13">&#39;r-o&#39;</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">plt.axis([</span><span style="color: #3677a9">1900</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">1920</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">100.0</span><span style="color: #d0d0d0">])</span>
<span style="color: #d0d0d0">plt.xlabel(</span><span style="color: #ed9d13">r&#39;Year&#39;</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">plt.ylabel(</span><span style="color: #ed9d13">r&#39;Numbers of hares and lynx &#39;</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">plt.legend((</span><span style="color: #ed9d13">&#39;Hares&#39;</span><span style="color: #d0d0d0">,</span><span style="color: #ed9d13">&#39;Lynx&#39;</span><span style="color: #d0d0d0">),</span> <span style="color: #d0d0d0">loc=</span><span style="color: #ed9d13">&#39;upper right&#39;</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">plt.title(</span><span style="color: #ed9d13">r&#39;Population of hares and lynx from 1900-1920 (x1000)}&#39;</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">plt.savefig(</span><span style="color: #ed9d13">&#39;Hudson_Bay_data.pdf&#39;</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">plt.savefig(</span><span style="color: #ed9d13">&#39;Hudson_Bay_data.png&#39;</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">plt.show()</span>
</pre></div>

</div>


<p>

</section>


<section>

<h2 id="___sec24">Hares and lynx in Hudson bay from 1900 to 1920 </h2>

<p>
<center><p><img src="fig/Hudson_Bay_data.png" align="bottom" width=700></p></center>

<p>

</section>


<section>

<h2 id="___sec25">Why now create a computer model for the hare and lynx populations? </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
 <p><li> We see oscillations in the data</li>
 <p><li> What causes cycles to slow or speed up?</li>
 <p><li> What affects the amplitude of the oscillation or do you expect to see the oscillations damp to a stable equilibrium?</li>
 <p><li> With a model we can better <em>understand the data</em></li>
 <p><li> More important: we can understand the ecology dynamics of
   predator-pray populations</li>
</ul>
</div>


<p>

</section>


<section>

<h2 id="___sec26">The traditional (top-down) approach </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The classical way (in all books) is to present the Lotka-Volterra equations:

<p>&nbsp;<br>
$$
\begin{align*}
\frac{dH}{dt} &= H(a - b L)\\ 
\frac{dL}{dt} &= - L(d - c  H)
\end{align*}
$$
<p>&nbsp;<br>


<p>
Here,

<ul>
 <p><li> \( H \) is the number of preys</li>
 <p><li> \( L \) the number of predators</li>
 <p><li> \( a \), \( b \), \( d \), \( c \) are parameters</li>
</ul>
<p>

Most books quickly establish the model and then use considerable space on
discussing the qualitative properties of this <em>nonlinear system of
ODEs</em> (which cannot be solved)
</div>


<p>

</section>


<section>

<h2 id="___sec27">The &quot;new&quot; discrete bottom-up approach </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>The bottom-up approach.</b>
<p>


<ul>
 <p><li class="fragment"> Start with experimental data and discuss the methods which have been used to collect the data, the assumptions, the electronic devices, the aims etc. That is, expose the students to the theory and assumptions behind the data that have been collected and motivate for the scientific method.</li>
 <p><li class="fragment"> Where appropriate the students should do the experiment(s) needed to collect the data.</li>
 <p><li class="fragment"> The first programming tasks are to read and visualize the data to see if there are patterns or regularities. This strengthens a research-driven intuition.</li>
 <p><li class="fragment"> Now we want to increase the understanding through modeling.</li>
 <p><li class="fragment"> Most of the biology lies in the <em>derivation</em> of the model. We shall
   focus on an intuitive discrete approach that leads to difference
   equations that can be programmed <em>and solved</em> directly.</li>
</ul>


</div>


<p>

</section>


<section>

<h2 id="___sec28">Basic (computer-friendly) mathematics notation </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
 <p><li> Time points: \( t_0,t_1,\ldots,t_m \)</li>
 <p><li> Uniform distribution of time points: \( t_n=n\Delta t \)</li>
 <p><li> \( H^n \): population of hares at time \( t_n \)</li>
 <p><li> \( L^n \): population of lynx at time \( t_n \)</li>
 <p><li> We want to model the changes in populations, \( \Delta H=H^{n+1}-H^n \)
   and \( \Delta L=L^{n+1}-L^n \) during a general time interval \( [t_{n+1},t_n] \)
   of length \( \Delta t=t_{n+1}-t_n \)</li>
</ul>
</div>


<p>

</section>


<section>

<h2 id="___sec29">Basic dynamics of the population of hares </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The population of hares evolves due to births and deaths exactly as a bacteria population:

<p>&nbsp;<br>
$$
\Delta H = a \Delta t H^n
$$
<p>&nbsp;<br>

However, hares have an additional loss in the population because
they are eaten by lynx.
All the hares and lynx can form
\( H\cdot L \) pairs in total. When such pairs meet during a time
interval \( \Delta t \), there is some
small probablity that the lynx will eat the hare.
So in fraction \( b\Delta t HL \), the lynx eat hares. This
loss of hares and must be accounted for:
subtracted in the equation for hares:

<p>&nbsp;<br>
$$ \Delta H = a\Delta t H^n - b \Delta t H^nL^n$$
<p>&nbsp;<br>
</div>


<p>

</section>


<section>

<h2 id="___sec30">Basic dynamics of the population of lynx </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
We assume that the primary growth for the lynx population depends on sufficient food for raising lynx kittens, which implies an adequate source of nutrients from predation on hares. Thus, the growth of the lynx population does not only depend of how many lynx there are, but on how many hares they can eat.
In a time interval \( \Delta t HL \) hares and lynx can meet, and in a
fraction \( b\Delta t HL \) the lynx eats the hare. All of this does not
contribute to the growth of lynx, again just a fraction of
\( b\Delta t HL \) that we write as
\( d\Delta t HL \). In addition, lynx die just as in the population
dynamics with one isolated animal population, leading to a loss
\( -c\Delta t L \).
</div>


<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The accounting of lynx then looks like
<p>&nbsp;<br>
$$ \Delta L = d\Delta t H^nL^n - c\Delta t L^n$$
<p>&nbsp;<br>
</div>


<p>

</section>


<section>

<h2 id="___sec31">Evolution equations </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
By writing up the definition of \( \Delta H \) and \( \Delta L \), and putting
all assumed known terms \( H^n \) and \( L^n \) on the right-hand side, we have

<p>&nbsp;<br>
$$ H^{n+1} = H^n + a\Delta t H^n - b\Delta t H^n L^n $$
<p>&nbsp;<br>


<p>&nbsp;<br>
$$ L^{n+1} = L^n + d\Delta t H^nL^n - c\Delta t L^n $$
<p>&nbsp;<br>


<p>
Note:

<ul>
 <p><li> These equations are ready to be implemented!</li>
 <p><li> But to start, we need \( H^0 \) and \( L^0 \) <br />
   (which we can get from the data)</li>
 <p><li> We also need values for \( a \), \( b \), \( d \), \( c \)</li>
</ul>
</div>


<p>

</section>


<section>

<h2 id="___sec32">Adapt the model to the Hudson Bay case </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
 <p><li> As always, models tend to be general - as here, applicable
   to &quot;all&quot; predator-pray systems</li>
 <p><li> The critical issue is whether the <em>interaction</em> between hares and lynx
   is sufficiently well modeled by \( \hbox{const}HL \)</li>
 <p><li> The parameters \( a \), \( b \), \( d \), and \( c \) must be
   estimated from data</li>
 <p><li> Measure time in years</li>
 <p><li> \( t_0=1900 \), \( t_m=1920 \)</li>
</ul>
</div>


<p>

</section>


<section>

<h2 id="___sec33">The program </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
<p>

<!-- code=python (!bc pypro) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">import</span> <span style="color: #447fcf; text-decoration: underline">numpy</span> <span style="color: #6ab825; font-weight: bold">as</span> <span style="color: #447fcf; text-decoration: underline">np</span>
<span style="color: #6ab825; font-weight: bold">import</span> <span style="color: #447fcf; text-decoration: underline">matplotlib.pyplot</span> <span style="color: #6ab825; font-weight: bold">as</span> <span style="color: #447fcf; text-decoration: underline">plt</span>

<span style="color: #6ab825; font-weight: bold">def</span> <span style="color: #447fcf">solver</span><span style="color: #d0d0d0">(m,</span> <span style="color: #d0d0d0">H0,</span> <span style="color: #d0d0d0">L0,</span> <span style="color: #d0d0d0">dt,</span> <span style="color: #d0d0d0">a,</span> <span style="color: #d0d0d0">b,</span> <span style="color: #d0d0d0">c,</span> <span style="color: #d0d0d0">d,</span> <span style="color: #d0d0d0">t0):</span>
    <span style="color: #ed9d13">&quot;&quot;&quot;Solve the difference equations for H and L over m years</span>
<span style="color: #ed9d13">    with time step dt (measured in years.&quot;&quot;&quot;</span>

    <span style="color: #d0d0d0">num_intervals</span> <span style="color: #d0d0d0">=</span> <span style="color: #24909d">int</span><span style="color: #d0d0d0">(m/</span><span style="color: #24909d">float</span><span style="color: #d0d0d0">(dt))</span>
    <span style="color: #d0d0d0">t</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">np.linspace(t0,</span> <span style="color: #d0d0d0">t0</span> <span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">m,</span> <span style="color: #d0d0d0">num_intervals+</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">)</span>
    <span style="color: #d0d0d0">H</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">np.zeros(t.size)</span>
    <span style="color: #d0d0d0">L</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">np.zeros(t.size)</span>

    <span style="color: #6ab825; font-weight: bold">print</span> <span style="color: #ed9d13">&#39;Init:&#39;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">H0,</span> <span style="color: #d0d0d0">L0,</span> <span style="color: #d0d0d0">dt</span>
    <span style="color: #d0d0d0">H[</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">H0</span>
    <span style="color: #d0d0d0">L[</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">L0</span>

    <span style="color: #6ab825; font-weight: bold">for</span> <span style="color: #d0d0d0">n</span> <span style="color: #6ab825; font-weight: bold">in</span> <span style="color: #24909d">range</span><span style="color: #d0d0d0">(</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">,</span> <span style="color: #24909d">len</span><span style="color: #d0d0d0">(t)-</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">):</span>
        <span style="color: #d0d0d0">H[n+</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">H[n]</span> <span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">a*dt*H[n]</span> <span style="color: #d0d0d0">-</span> <span style="color: #d0d0d0">b*dt*H[n]*L[n]</span>
        <span style="color: #d0d0d0">L[n+</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">L[n]</span> <span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">d*dt*H[n]*L[n]</span> <span style="color: #d0d0d0">-</span> <span style="color: #d0d0d0">c*dt*L[n]</span>
    <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #d0d0d0">H,</span> <span style="color: #d0d0d0">L,</span> <span style="color: #d0d0d0">t</span>

<span style="color: #999999; font-style: italic"># Load in data file</span>
<span style="color: #d0d0d0">data</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">np.loadtxt(</span><span style="color: #ed9d13">&#39;Hudson_Bay.csv&#39;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">delimiter=</span><span style="color: #ed9d13">&#39;,&#39;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">skiprows=</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">)</span>
<span style="color: #999999; font-style: italic"># Make arrays containing x-axis and hares and lynx populations</span>
<span style="color: #d0d0d0">t_e</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">data[:,</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">]</span>
<span style="color: #d0d0d0">H_e</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">data[:,</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]</span>
<span style="color: #d0d0d0">L_e</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">data[:,</span><span style="color: #3677a9">2</span><span style="color: #d0d0d0">]</span>

<span style="color: #999999; font-style: italic"># Simulate using the model</span>
<span style="color: #d0d0d0">H,</span> <span style="color: #d0d0d0">L,</span> <span style="color: #d0d0d0">t</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">solver(m=</span><span style="color: #3677a9">20</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">H0=</span><span style="color: #3677a9">34.91</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">L0=</span><span style="color: #3677a9">3.857</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">dt=</span><span style="color: #3677a9">0.1</span><span style="color: #d0d0d0">,</span>
                 <span style="color: #d0d0d0">a=</span><span style="color: #3677a9">0.4807</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">b=</span><span style="color: #3677a9">0.02482</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">c=</span><span style="color: #3677a9">0.9272</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">d=</span><span style="color: #3677a9">0.02756</span><span style="color: #d0d0d0">,</span>
                 <span style="color: #d0d0d0">t0=</span><span style="color: #3677a9">1900</span><span style="color: #d0d0d0">)</span>

<span style="color: #999999; font-style: italic"># Visualize simulations and data</span>
<span style="color: #d0d0d0">plt.plot(t_e,</span> <span style="color: #d0d0d0">H_e,</span> <span style="color: #ed9d13">&#39;b-+&#39;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">t_e,</span> <span style="color: #d0d0d0">L_e,</span> <span style="color: #ed9d13">&#39;r-o&#39;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">t,</span> <span style="color: #d0d0d0">H,</span> <span style="color: #ed9d13">&#39;m--&#39;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">t,</span> <span style="color: #d0d0d0">L,</span> <span style="color: #ed9d13">&#39;k--&#39;</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">plt.xlabel(</span><span style="color: #ed9d13">&#39;Year&#39;</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">plt.ylabel(</span><span style="color: #ed9d13">&#39;Numbers of hares and lynx&#39;</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">plt.axis([</span><span style="color: #3677a9">1900</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">1920</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">140</span><span style="color: #d0d0d0">])</span>
<span style="color: #d0d0d0">plt.title(</span><span style="color: #ed9d13">r&#39;Population of hares and lynx 1900-1920 (x1000)&#39;</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">plt.legend((</span><span style="color: #ed9d13">&#39;H_e&#39;</span><span style="color: #d0d0d0">,</span> <span style="color: #ed9d13">&#39;L_e&#39;</span><span style="color: #d0d0d0">,</span> <span style="color: #ed9d13">&#39;H&#39;</span><span style="color: #d0d0d0">,</span> <span style="color: #ed9d13">&#39;L&#39;</span><span style="color: #d0d0d0">),</span> <span style="color: #d0d0d0">loc=</span><span style="color: #ed9d13">&#39;upper left&#39;</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">plt.savefig(</span><span style="color: #ed9d13">&#39;Hudson_Bay_sim.pdf&#39;</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">plt.savefig(</span><span style="color: #ed9d13">&#39;Hudson_Bay_sim.png&#39;</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">plt.show()</span>
</pre></div>

</div>


<p>

</section>


<section>

<h2 id="___sec34">The plot </h2>

<p>
<center><p><img src="fig/Hudson_Bay_sim.png" align="bottom" width=700></p></center>

<p>

</section>


<section>

<h2 id="___sec35">Other examples </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
 <p><li> <a href="http://hplgit.github.io/disease-modeling/doc/web/index.html" target="_self">Disease modeling</a></li>
 <p><li> Predator-pray with disease</li>
 <p><li> <a href="http://hplgit.github.io/bioinf-py/doc/web/index.html" target="_self">Bioinformatics: searching in strings</a></li>
 <p><li> Move from difference equations to differential equations, would this be meaningful? Probably not - it does not give anything in biology before the models are so complex that one needs other things than Forward Euler...</li>
</ul>
</div>


<p>


</section>



</div> <!-- class="slides" -->
</div> <!-- class="reveal" -->

<script src="reveal.js/lib/js/head.min.js"></script>
<script src="reveal.js/js/reveal.min.js"></script>

<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

    // Display navigation controls in the bottom right corner
    controls: true,

    // Display progress bar (below the horiz. slider)
    progress: true,

    // Display the page number of the current slide
    slideNumber: true,

    // Push each slide change to the browser history
    history: false,

    // Enable keyboard shortcuts for navigation
    keyboard: true,

    // Enable the slide overview mode
    overview: true,

    // Vertical centering of slides
    //center: true,
    center: false,

    // Enables touch navigation on devices with touch input
    touch: true,

    // Loop the presentation
    loop: false,

    // Change the presentation direction to be RTL
    rtl: false,

    // Turns fragments on and off globally
    fragments: true,

    // Flags if the presentation is running in an embedded mode,
    // i.e. contained within a limited portion of the screen
    embedded: false,

    // Number of milliseconds between automatically proceeding to the
    // next slide, disabled when set to 0, this value can be overwritten
    // by using a data-autoslide attribute on your slides
    autoSlide: 0,

    // Stop auto-sliding after user input
    autoSlideStoppable: true,

    // Enable slide navigation via mouse wheel
    mouseWheel: false,

    // Hides the address bar on mobile devices
    hideAddressBar: true,

    // Opens links in an iframe preview overlay
    previewLinks: false,

    // Transition style
    transition: 'default', // default/cube/page/concave/zoom/linear/fade/none

    // Transition speed
    transitionSpeed: 'default', // default/fast/slow

    // Transition style for full page slide backgrounds
    backgroundTransition: 'default', // default/none/slide/concave/convex/zoom

    // Number of slides away from the current that are visible
    viewDistance: 3,

    // Parallax background image
    //parallaxBackgroundImage: '', // e.g. "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'"

    // Parallax background size
    //parallaxBackgroundSize: '' // CSS syntax, e.g. "2100px 900px"

    theme: Reveal.getQueryHash().theme, // available themes are in reveal.js/css/theme
    transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/none

});

Reveal.initialize({
    dependencies: [
        // Cross-browser shim that fully implements classList - https://github.com/eligrey/classList.js/
        { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },

        // Interpret Markdown in <section> elements
        { src: 'reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
        { src: 'reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },

        // Syntax highlight for <code> elements
        { src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },

        // Zoom in and out with Alt+click
        { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },

        // Speaker notes
        { src: 'reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },

        // Remote control your reveal.js presentation using a touch device
        //{ src: 'reveal.js/plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } },

        // MathJax
        //{ src: 'reveal.js/plugin/math/math.js', async: true }
    ]
});

Reveal.initialize({

    // The "normal" size of the presentation, aspect ratio will be preserved
    // when the presentation is scaled to fit different resolutions. Can be
    // specified using percentage units.
    width: 1170,  // original: 960,
    height: 700,

    // Factor of the display size that should remain empty around the content
    margin: 0.1,

    // Bounds for smallest/largest possible scale to apply to content
    minScale: 0.2,
    maxScale: 1.0

});
</script>

<!-- begin footer logo
<div style="position: absolute; bottom: 0px; left: 0; margin-left: 0px">
<img src="somelogo.png">
</div>
     end footer logo -->



</body>
</html>
